
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Copying (root) CA certificates onto Arduino devices &#8212; notes</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/vollkorn.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/styles.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Arduino cookbook" href="arduino-cookbook.html" />
    <link rel="prev" title="PlatformIO notes" href="platformio.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../titlepage.html">
   notes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Systems
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../nix-systems/index.html">
   *nix Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/nix-installations.html">
     Software installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/nix-sysadmin.html">
     System administration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/nix-filesystem.html">
     Disk and filesystem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/nix-networks.html">
     Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/nix-hardware.html">
     Hardware
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/boot-bios.html">
     Boot Loaders and BIOS control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/systemd.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       systemd
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       journald
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nix-systems/kernel.html">
     Linux Kernel Modules
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../bash/index.html">
   Bash scripting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../bash/bash-reference.html">
     Bash reference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bash/bash-cookbook.html">
     Bash cookbook
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../osx-reference.html">
   OSX Reference
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Programming Languages
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cpp/index.html">
   C++ and C
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cpp/declarations.html">
     Declarations in C++
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cpp/conan.html">
     Conan package manager
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cpp/unit-testing.html">
     Unit testing with Catch2! and Trompeloeil
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cpp/swig-cmake.html">
     Using SWIG with CMake
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cpp/cmake.html">
     CMake notes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cpp/member-functions.html">
     On using
     <code class="docutils literal notranslate">
      <span class="pre">
       std::function
      </span>
     </code>
     for member functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../julia/index.html">
   Julia Notes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../julia/julia-intro.html">
     Julia learning notes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../julia/advent-notes/README.html">
     Advent of Code notes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../julia/advent-notes/scopes.html">
     Julia Scopes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python/index.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/py-recipes.html">
     Python recipes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/jupyter-ipython.html">
     Jupyter and iPython cheat sheet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/regex.html">
     Regex in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/py-serial.html">
     Serial communication with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/high-perf.html">
     High performance Python techniques and paradigms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/c-wrapping.html">
     Wrapping C and C++ into Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/pypi-distribution.html">
     Making a project available on pypi
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/cpp-c-swig.html">
     Wrapping C/C++ code using SWIG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/requests.html">
     Python
     <code class="docutils literal notranslate">
      <span class="pre">
       requests
      </span>
     </code>
     cookbook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/flask/using-flask.html">
     Using Python Flask
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/flask/rethink-db-with-flask.html">
     Using RethinkDB with Flask
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/flask/jinja-templating.html">
     Templating HTML pages with jinja
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/fast-api/using-fast-api.html">
     Using FastAPI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/mkdocs-notes.html">
     Notes on mkdocs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python/scrapy.html">
     Scrapy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../js/index.html">
   JavaScript
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../js/jest-testing.html">
     Using Jest testing framework
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../js/js-reference.html">
     JavaScript language reference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../js/swig-nodejs.html">
     Using SWIG with NodeJS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../js/request-parsing.html">
     Making HTTP requests and parsing in JS and node.js
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../js/extensions/native-messaging.html">
     Native Messaging for Browser Extensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../js/vue/over-vue.html">
     Vue Overview
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tex/index.html">
   LaTeX
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tex/latex-documents.html">
     Writing LaTeX documents
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tex/latexmk.html">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       latexmk
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tex/presentations.html">
     Making presentations in LaTeX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tex/posters.html">
     Creating posters in LaTeX
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DevOps
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docker/index.html">
   Docker
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docker/minio-registry.html">
     Creating a persistent local registry with S3/MinIO
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docker/docker-cheatsheet.html">
     Docker cheatsheet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docker/systemd-with-docker.html">
     Using Docker as
     <code class="docutils literal notranslate">
      <span class="pre">
       systemd
      </span>
     </code>
     services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docker/docker-compose.html">
     The magical world of Docker-Compose
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docker/dockerfile-recipes.html">
     Dockerfile cookbook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docker/docker-swarm.html">
     Docker Swarm
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../aws/index.html">
   Amazon Web Services
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../aws/vpc-overview.html">
     VPC overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aws/setting-up.html">
     AWS Settup
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aws/ec2-with-docker.html">
     EC2 with Docker
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aws/goofys-s3.html">
     Using Goofys with S3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../vms/index.html">
   Virtual Machines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../vms/sun-virtual-box.html">
     Oracle Virtual Box
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vms/kvm.html">
     Kernel-based Virtual Machine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vms/qemu.html">
     QEMU
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../databases/index.html">
   Databases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../databases/node-red.html">
     NodeRed Notes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../databases/mongo-db.html">
     Using MongoDB
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../databases/rethink-db.html">
     RethinkDB
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../databases/lang-drivers/py-mongo.html">
     Using MongoDB and Python
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Configurations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../configurations/shell-rc-profiles.html">
   Shell
   <code class="docutils literal notranslate">
    <span class="pre">
     .*rc
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     .*profile
    </span>
   </code>
   configurations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../configurations/jupyter-notebook.html">
   Jupyter notebook
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../machine-learning/index.html">
   Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../machine-learning/tf-install.html">
   Installing TensorFlow 2.0
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Raspi &amp; Arduino
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../raspi/index.html">
   Raspberry Pi
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../raspi/raspi-config.html">
     Configuring a Raspberry Pi from fresh install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../raspi/raspi-bit-torrent.html">
     Setting up a Raspberry-Pi for secure bit torrenting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../raspi/pyaudio.html">
     Installing PyAudio on Raspberry Pi
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Arduino
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="platformio.html">
     PlatformIO notes
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Copying (root) CA certificates onto Arduino devices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="arduino-cookbook.html">
     Arduino cookbook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="crypto-auth.html">
     Using the ECC0X08 with Arduino devices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mq-mqtt/mqtt-specs.html">
     MQTT Specifications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mq-mqtt/nginx-load-balancing.html">
     Using NGiNX with Docker
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../vim/index.html">
   VIM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../vim/recipes.html">
     Vim Recipes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vim/vundle.html">
     Vundle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vim/batch-rename.html">
     Batch renaming in Vim
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../discord/index.html">
   Discord
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../discord/making-bots-python.html">
     Making Discord bots in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discord/discord-music-hook.html">
     Creating a Discord music feed using webhooks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../git/index.html">
   Git and VCs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../git/git-reference.html">
     Git Reference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../git/gitea-mariadb.html">
     Using Gitea with MariaDB
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../vscode/index.html">
   VSCode
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../vscode/publishing.html">
     Publishing a VSCode extension
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../recommended-talks.html">
   Recommended talks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software-design-principles.html">
   Software Design Principles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ffmpeg-cheatsheet.html">
   FFMPEG Cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iptables-and-firewalls.html">
   <code class="docutils literal notranslate">
    <span class="pre">
     iptables
    </span>
   </code>
   and firewall configuration reference.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ci-cd/jenkins-recipes.html">
   Jenkins Cookbook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../security/openssl-cookbook.html">
   OpenSSL Cookbook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../visualisation/blender-learning.html">
   Learning Blender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../java/gradle-cookbook.html">
   Gradle build-tool cookbook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../automation/mycroft-osx.html">
   Using Mycroft Docker images on OSX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../nix-systems/clamav.html">
   Clam Anti-Virus
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/arduino/ca-certs-nano.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/fjebaker/notes"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/fjebaker/notes/issues/new?title=Issue%20on%20page%20%2Farduino/ca-certs-nano.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/fjebaker/notes/edit/master/arduino/ca-certs-nano.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wifi-nina-toolkit">
   WiFi(Nina) Toolkit
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#brief-discussion-of-the-library-state">
     Brief discussion of the library state
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-shipped-toolkit-with-custom-ca-certificates">
   Using the shipped Toolkit with custom CA certificates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wireshark">
     Wireshark
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#openssl-to-view-certificate-chains">
     OpenSSL to view certificate chains
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#configuring-a-ca">
     Configuring a CA
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reverse-engineering-the-shipped-toolkit-with-custom-ca-certificates">
   Reverse-engineering the shipped Toolkit with custom CA certificates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-other-libraries">
   Using other Libraries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bearssl">
     BearSSL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ameba-iot-devices">
     Ameba IoT devices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mbedtls">
     mbedTLS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wip-links">
     WiP links
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Copying (root) CA certificates onto Arduino devices</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wifi-nina-toolkit">
   WiFi(Nina) Toolkit
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#brief-discussion-of-the-library-state">
     Brief discussion of the library state
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-shipped-toolkit-with-custom-ca-certificates">
   Using the shipped Toolkit with custom CA certificates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wireshark">
     Wireshark
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#openssl-to-view-certificate-chains">
     OpenSSL to view certificate chains
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#configuring-a-ca">
     Configuring a CA
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reverse-engineering-the-shipped-toolkit-with-custom-ca-certificates">
   Reverse-engineering the shipped Toolkit with custom CA certificates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-other-libraries">
   Using other Libraries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bearssl">
     BearSSL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ameba-iot-devices">
     Ameba IoT devices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mbedtls">
     mbedTLS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wip-links">
     WiP links
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="copying-root-ca-certificates-onto-arduino-devices">
<h1>Copying (root) CA certificates onto Arduino devices<a class="headerlink" href="#copying-root-ca-certificates-onto-arduino-devices" title="Permalink to this headline">¶</a></h1>
<p>Certificate authority (CA) certificates are the basis for secure and trustworthy transport layer security (TLS). Depending on the Arduino library used, the methods for copying these certificates onto the device can vary. Here I document my exploration of this task, using the WiFiNina library, and the <a class="reference external" href="https://store.arduino.cc/arduino-nano-33-iot">Arduino Nano 33 IoT</a>.</p>
<p>Note, there is a discussion as to the security of different WiFi chips, and whether they are SSL/TLS compatible in the <a class="reference external" href="https://forum.arduino.cc/index.php?topic=679562.0">Arduino forums</a>.</p>
<!--BEGIN TOC-->
<div class="section" id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#wifinina-toolkit">WiFi(Nina) Toolkit</a></p>
<ol class="simple">
<li><p><a class="reference external" href="#brief-discussion-of-the-library-state">Brief discussion of the library state</a></p></li>
</ol>
</li>
<li><p><a class="reference external" href="#using-the-shipped-toolkit-with-custom-ca-certificates">Using the shipped Toolkit with custom CA certificates</a></p>
<ol class="simple">
<li><p><a class="reference external" href="#wireshark">Wireshark</a></p></li>
<li><p><a class="reference external" href="#openssl-to-view-certificate-chains">OpenSSL to view certificate chains</a></p></li>
<li><p><a class="reference external" href="#configuring-a-ca">Configuring a CA</a></p></li>
</ol>
</li>
<li><p><a class="reference external" href="#reverse-engineering-the-shipped-toolkit-with-custom-ca-certificates">Reverse-engineering the shipped Toolkit with custom CA certificates</a></p></li>
<li><p><a class="reference external" href="#using-other-libraries">Using other Libraries</a></p>
<ol class="simple">
<li><p><a class="reference external" href="#bearssl">BearSSL</a></p></li>
<li><p><a class="reference external" href="#ameba-iot-devices">Ameba IoT devices</a></p></li>
<li><p><a class="reference external" href="#mbedtls">mbedTLS</a></p></li>
<li><p><a class="reference external" href="#wip-links">WiP links</a></p></li>
</ol>
</li>
</ol>
<!--END TOC-->
</div>
<div class="section" id="wifi-nina-toolkit">
<h2>WiFi(Nina) Toolkit<a class="headerlink" href="#wifi-nina-toolkit" title="Permalink to this headline">¶</a></h2>
<p>The arduino WiFi and <a class="reference external" href="https://www.arduino.cc/en/Reference/WiFiNINA">WiFiNina</a> both ship with a tool for updating the device’s firmware, and copying new certificates. There are <a class="reference external" href="https://www.arduino.cc/en/Tutorial/WiFiNINAFirmwareUpdater">tutorials</a> on the internet as to how to accomplish this, but a brief summary of the simplest method is as follows</p>
<ul class="simple">
<li><p>install the Arduino IDE</p></li>
<li><p>under Tools -&gt; Manage Libraries, install the WiFi(Nina)</p></li>
<li><p>load the example sketch, under File -&gt; Examples -&gt; WiFi(Nina) -&gt; Tools -&gt; Firmware Updater, and upload it onto your MC device</p></li>
<li><p>under Tools, select the WiFi101 / WiFiNina Firmware Updater, and follow the Toolkit’s instructions</p></li>
</ul>
<p>The final section of the tool allows you to enter the desired domains you wish to access with the device over SSL/TLS, and the device will then receive the root CA certificates in order to complete that task. As such, the security of the device is in only allowing specific domains to be trustfully accessed, preventing some Man-in-the-Middle attacks (MitM). However, uploading custom CA certificates, for, e.g. a home server, becomes more involved, since you would have to provide a domain where the certificate may be accessed; understanding exactly how these certificates are obtained by the Toolkit also requires exploration to complete this.</p>
<p>There exist essentially two solutions then, in uploading a custom CA onto the device; either providing an endpoint on your server where the Toolkit may fetch it, so that it may be uploaded, or reverse-engineering the Firmware Updater sketch, and feeding the device your own <code class="docutils literal notranslate"><span class="pre">.pem</span></code> or <code class="docutils literal notranslate"><span class="pre">.cert</span></code> files.</p>
<div class="section" id="brief-discussion-of-the-library-state">
<h3>Brief discussion of the library state<a class="headerlink" href="#brief-discussion-of-the-library-state" title="Permalink to this headline">¶</a></h3>
<p>Unfortunately, despite quite extensive research, I have not found an easier way of adding certificates onto these IoT devices. I found discussion in some forums about the <a class="reference external" href="https://github.com/arduino/nina-fw">official Nina Firmware</a>, and how you could compile and flash the device with your own keys inserted in <code class="docutils literal notranslate"><span class="pre">data/roots.pem</span></code>, but that is itself not a straight-forward task, and requires additional tools. My general approach is always to install the minimal amount of new software on my main machine, so I’ve dismissed that for now.</p>
<p>I saw in a repository issue (<a class="reference external" href="https://github.com/arduino/nina-fw/issues/10">issue #10</a>) that a feature will be added that solves this problem of uploading certificate files. Until then, and for my own learning, I will explore an alternative solution.</p>
</div>
</div>
<div class="section" id="using-the-shipped-toolkit-with-custom-ca-certificates">
<h2>Using the shipped Toolkit with custom CA certificates<a class="headerlink" href="#using-the-shipped-toolkit-with-custom-ca-certificates" title="Permalink to this headline">¶</a></h2>
<p>First I wanted to know if the root certificates aquired by the Toolkit are done by the arduino device, or by the host machine before uploading. An info message during the upload step shows that the Toolkit is fetching the certificates, however it did not describe in detail how it achieves this, nor explicitly which device was acquiring the keys.</p>
<div class="section" id="wireshark">
<h3>Wireshark<a class="headerlink" href="#wireshark" title="Permalink to this headline">¶</a></h3>
<p>I monitored my network traffic whilst running the certificate tookit with the domain <code class="docutils literal notranslate"><span class="pre">arduino.cc:443</span></code>. Filtering with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span><span class="o">.</span><span class="n">addr</span> <span class="o">==</span> <span class="mf">192.168.1.120</span> <span class="ow">and</span> <span class="n">ip</span><span class="o">.</span><span class="n">addr</span> <span class="o">==</span> <span class="mf">100.24.172.113</span>
</pre></div>
</div>
<p>where the first is my machine’s IP address, and the latter the IP of <code class="docutils literal notranslate"><span class="pre">arduino.cc</span></code>. We see in the logs the full TLS handshake, key exchange, and cipher specification.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Source          Destination     Protocol    Length  Info
---------------|---------------|-----------|-------|------------------------------------------------
192.168.1.120   100.24.172.113  TLSv1.2     275     Client Hello
100.24.172.113  192.168.1.120   TCP         66      443 → 59172 [ACK]
100.24.172.113  192.168.1.120   TLSv1.2     1514    Server Hello
100.24.172.113  192.168.1.120   TLSv1.2     1514    Certificate [TCP segment of a reassembled PDU]
192.168.1.120   100.24.172.113  TCP         66      59172 → 443 [ACK]
100.24.172.113  192.168.1.120   TLSv1.2     166     Server Key Exchange, Server Hello Done
192.168.1.120   100.24.172.113  TCP         66      59172 → 443 [ACK]
192.168.1.120   100.24.172.113  TLSv1.2     141     Client Key Exchange
192.168.1.120   100.24.172.113  TLSv1.2     72      Change Cipher Spec
192.168.1.120   100.24.172.113  TLSv1.2     111     Encrypted Handshake Message
100.24.172.113  192.168.1.120   TCP         66      443 → 59172 [ACK]
100.24.172.113  192.168.1.120   TLSv1.2     117     Change Cipher Spec, Encrypted Handshake Message
192.168.1.120   100.24.172.113  TCP         66      59172 → 443 [ACK]
192.168.1.120   100.24.172.113  TLSv1.2     97      Encrypted Alert
</pre></div>
</div>
<p>The interaction ends with an <code class="docutils literal notranslate"><span class="pre">Encrypted</span> <span class="pre">Alert</span></code>; if we examine this package</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TLSv1</span><span class="mf">.2</span> <span class="n">Record</span> <span class="n">Layer</span><span class="p">:</span> <span class="n">Encrypted</span> <span class="n">Alert</span>
    <span class="n">Content</span> <span class="n">Type</span><span class="p">:</span> <span class="n">Alert</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>
    <span class="n">Version</span><span class="p">:</span> <span class="n">TLS</span> <span class="mf">1.2</span> <span class="p">(</span><span class="mh">0x0303</span><span class="p">)</span>
    <span class="n">Length</span><span class="p">:</span> <span class="mi">26</span>
    <span class="n">Alert</span> <span class="n">Message</span><span class="p">:</span> <span class="n">Encrypted</span> <span class="n">Alert</span>
</pre></div>
</div>
<p>we don’t see much. I read on forums that these sort of <code class="docutils literal notranslate"><span class="pre">Alert</span> <span class="pre">(21)</span></code>s are an ambiguous alert, and would have to be decoded using the TLS keys (a <a class="reference external" href="https://community.cisco.com/t5/network-security/ssl-content-type-alert-21/td-p/1218378">CISCO comment</a> suggests Wireshark may be able to do this automatically, else the keys can be obtained using other methods). For now, this is a task for a slow day, and one I may revisit later.</p>
<p>The general handshake however clues in that we may be able to just host a <code class="docutils literal notranslate"><span class="pre">443</span></code> socket on our webserver, which is TLS savvy, and let the Toolkit fetch the root certificate for us (our custom CA in this case), and add it to the device. A possible caveat of this is that the handshake may be rejected by the host machine, unless the custom CA is added to the host’s keychain – something that is completely acceptable to do, but none the less is something I am reluctant to do. My views on this sort of a topic are that I want the IoT device only to be able to connect to this server securely and reliably, and don’t wish to have to pollute other machines to accomplish this.</p>
</div>
<div class="section" id="openssl-to-view-certificate-chains">
<h3>OpenSSL to view certificate chains<a class="headerlink" href="#openssl-to-view-certificate-chains" title="Permalink to this headline">¶</a></h3>
<p>Another handy technique when examining this sort of a problem, and one that may come in handy when testing the success of either solution, is to view the certificate chains, and examine exactly which CA is the root. Examining the <code class="docutils literal notranslate"><span class="pre">Server</span> <span class="pre">Hello</span></code> packet from the Wireshark capture a little closer, we see</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="mf">00e0</span>   <span class="mi">0</span><span class="n">b</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">30</span> <span class="mi">4</span><span class="n">a</span> <span class="mi">31</span> <span class="mi">0</span><span class="n">b</span> <span class="mi">30</span> <span class="mi">09</span> <span class="mi">06</span> <span class="mi">03</span> <span class="mi">55</span> <span class="mi">04</span> <span class="mi">06</span> <span class="mi">13</span> <span class="mi">02</span>   <span class="o">..</span><span class="mf">.0</span><span class="n">J1</span><span class="mf">.0</span><span class="o">...</span><span class="n">U</span><span class="o">....</span>
<span class="mi">00</span><span class="n">f0</span>   <span class="mi">55</span> <span class="mi">53</span> <span class="mi">31</span> <span class="mi">16</span> <span class="mi">30</span> <span class="mi">14</span> <span class="mi">06</span> <span class="mi">03</span> <span class="mi">55</span> <span class="mi">04</span> <span class="mi">0</span><span class="n">a</span> <span class="mi">13</span> <span class="mi">0</span><span class="n">d</span> <span class="mi">4</span><span class="n">c</span> <span class="mi">65</span> <span class="mi">74</span>   <span class="n">US1</span><span class="mf">.0</span><span class="o">...</span><span class="n">U</span><span class="o">....</span><span class="n">Let</span>
<span class="mi">0100</span>   <span class="mi">27</span> <span class="mi">73</span> <span class="mi">20</span> <span class="mi">45</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">63</span> <span class="mi">72</span> <span class="mi">79</span> <span class="mi">70</span> <span class="mi">74</span> <span class="mi">31</span> <span class="mi">23</span> <span class="mi">30</span> <span class="mi">21</span> <span class="mi">06</span> <span class="mi">03</span>   <span class="s1">&#39;s Encrypt1#0!..</span>
<span class="mi">0110</span>   <span class="mi">55</span> <span class="mi">04</span> <span class="mi">03</span> <span class="mi">13</span> <span class="mi">1</span><span class="n">a</span> <span class="mi">4</span><span class="n">c</span> <span class="mi">65</span> <span class="mi">74</span> <span class="mi">27</span> <span class="mi">73</span> <span class="mi">20</span> <span class="mi">45</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">63</span> <span class="mi">72</span> <span class="mi">79</span>   <span class="n">U</span><span class="o">....</span><span class="n">Let</span><span class="s1">&#39;s Encry</span>
<span class="mi">0120</span>   <span class="mi">70</span> <span class="mi">74</span> <span class="mi">20</span> <span class="mi">41</span> <span class="mi">75</span> <span class="mi">74</span> <span class="mi">68</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">72</span> <span class="mi">69</span> <span class="mi">74</span> <span class="mi">79</span> <span class="mi">20</span> <span class="mi">58</span> <span class="mi">33</span> <span class="mi">30</span>   <span class="n">pt</span> <span class="n">Authority</span> <span class="n">X30</span>
<span class="o">...</span>

</pre></div>
</div>
<p>a <code class="docutils literal notranslate"><span class="pre">Let's</span> <span class="pre">Encrypt</span></code> ASCII string. We can also probe the site with OpenSSL, using the command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>openssl s_client -showcerts -connect arduino.cc:443
</pre></div>
</div>
<p>which ouputs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
<span class="n">Certificate</span> <span class="n">chain</span>
 <span class="mi">0</span> <span class="n">s</span><span class="p">:</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">arduino</span><span class="o">.</span><span class="n">cc</span>
   <span class="n">i</span><span class="p">:</span><span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Let</span><span class="s1">&#39;s Encrypt/CN=Let&#39;</span><span class="n">s</span> <span class="n">Encrypt</span> <span class="n">Authority</span> <span class="n">X3</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">...</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
 <span class="mi">1</span> <span class="n">s</span><span class="p">:</span><span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Let</span><span class="s1">&#39;s Encrypt/CN=Let&#39;</span><span class="n">s</span> <span class="n">Encrypt</span> <span class="n">Authority</span> <span class="n">X3</span>
   <span class="n">i</span><span class="p">:</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Digital</span> <span class="n">Signature</span> <span class="n">Trust</span> <span class="n">Co</span><span class="o">./</span><span class="n">CN</span><span class="o">=</span><span class="n">DST</span> <span class="n">Root</span> <span class="n">CA</span> <span class="n">X3</span>
<span class="o">-----</span><span class="n">BEGIN</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">...</span>
<span class="o">-----</span><span class="n">END</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">---</span>
<span class="n">Server</span> <span class="n">certificate</span>
<span class="n">subject</span><span class="o">=/</span><span class="n">CN</span><span class="o">=</span><span class="n">arduino</span><span class="o">.</span><span class="n">cc</span>
<span class="n">issuer</span><span class="o">=/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">Let</span><span class="s1">&#39;s Encrypt/CN=Let&#39;</span><span class="n">s</span> <span class="n">Encrypt</span> <span class="n">Authority</span> <span class="n">X3</span>
<span class="o">---</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">s:</span></code> is the subject line, and <code class="docutils literal notranslate"><span class="pre">i:</span></code> informs us about the issuing authority. In the final lines of the output, we also see explicitly again that the issuer is <code class="docutils literal notranslate"><span class="pre">Let's</span> <span class="pre">Encrypt</span></code>. Presumably then, if we can construct a server where OpenSSL is able to fetch a certificate chain with our own certificate as the root, then the Toolkit should also be able to fetch and pass the certificate to our arduino device.</p>
<p>I will write more explicit <a class="reference external" href="https://github.com/fjebaker/notes/blob/master/security/ssl-tls-certificates.md">notes</a> on certificate authorities, SSL/TLS, and how to configure custom certificate chains at a later date, which will elaborate on different analysis methods more completely.</p>
</div>
<div class="section" id="configuring-a-ca">
<h3>Configuring a CA<a class="headerlink" href="#configuring-a-ca" title="Permalink to this headline">¶</a></h3>
<p>TODO</p>
</div>
</div>
<div class="section" id="reverse-engineering-the-shipped-toolkit-with-custom-ca-certificates">
<h2>Reverse-engineering the shipped Toolkit with custom CA certificates<a class="headerlink" href="#reverse-engineering-the-shipped-toolkit-with-custom-ca-certificates" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
<div class="section" id="using-other-libraries">
<h2>Using other Libraries<a class="headerlink" href="#using-other-libraries" title="Permalink to this headline">¶</a></h2>
<p>An alternative solution to all of this is to use a different library (though in doing so it could be argued we learn less). From digging for a solution using WiFiNina, I found a few other libraries which already improved upon what I was trying to accomplish, however with their own issues here an there.</p>
<div class="section" id="bearssl">
<h3>BearSSL<a class="headerlink" href="#bearssl" title="Permalink to this headline">¶</a></h3>
<p>BearSSL allows you do pass x.509 certificates, set trust anchors and Client RSA certificates. The prevelent issue with this library at the moment is securely injecting the certificates in such a way as to prevent them being accessed by a would-be intruder; storing them in the source code, as in the examples, is a very bad practice.</p>
<p>BearSSL builds on the <a class="reference external" href="https://github.com/esp8266/Arduino/tree/master/libraries/ESP8266WiFi">ESP8266WiFi</a> library, which includes a solution for reading in CA certificates during the <code class="docutils literal notranslate"><span class="pre">setup()</span></code> in the examples.</p>
<p>Other examples, such as the <a class="reference external" href="https://github.com/esp8266/Arduino/blob/master/libraries/ESP8266WiFi/examples/BearSSL_ServerClientCert/BearSSL_ServerClientCert.ino"><code class="docutils literal notranslate"><span class="pre">ServerClientCert</span></code></a> simply store the certificates as character arrays in the source code.</p>
<p>A PoC for BearSSL is provided <a class="reference external" href="https://github.com/tsi-software/Secure_ESP8266_MQTT_poc">here</a>, which includes full secure MQTT setup.</p>
<p><strong>NB:</strong> The ESP8266 is its own WiFi hardware chip, and thus these solutions will not work with the Arduino Nano 33 IoT’s u-blox NINA-W102. I’ve included them just for posterity, and maybe a little inspiration, if nothing else.</p>
</div>
<div class="section" id="ameba-iot-devices">
<h3>Ameba IoT devices<a class="headerlink" href="#ameba-iot-devices" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://www.instructables.com/id/Arduino-Using-AWS-IoT-Serivce/">https://www.instructables.com/id/Arduino-Using-AWS-IoT-Serivce/</a></p>
</div>
<div class="section" id="mbedtls">
<h3>mbedTLS<a class="headerlink" href="#mbedtls" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://tls.mbed.org/discussions/generic/mbedtls-configuration-for-google-iot">https://tls.mbed.org/discussions/generic/mbedtls-configuration-for-google-iot</a></p>
</div>
<div class="section" id="wip-links">
<h3>WiP links<a class="headerlink" href="#wip-links" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://forum.arduino.cc/index.php?topic=608492.0">https://forum.arduino.cc/index.php?topic=608492.0</a></p>
<p><a class="reference external" href="https://forum.arduino.cc/index.php?topic=526033.0">https://forum.arduino.cc/index.php?topic=526033.0</a> final tmp2k post</p>
<p><a class="reference external" href="https://www.savjee.be/2019/07/connect-esp32-to-aws-iot-with-arduino-code/">https://www.savjee.be/2019/07/connect-esp32-to-aws-iot-with-arduino-code/</a></p>
<p><a class="reference external" href="http://www.iotsharing.com/2017/08/how-to-use-esp32-mqtts-with-mqtts-mosquitto-broker-tls-ssl.html">http://www.iotsharing.com/2017/08/how-to-use-esp32-mqtts-with-mqtts-mosquitto-broker-tls-ssl.html</a> i wanna get an esp32</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./arduino"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="platformio.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">PlatformIO notes</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="arduino-cookbook.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Arduino cookbook</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Fergus Baker<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>